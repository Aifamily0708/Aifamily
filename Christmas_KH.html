<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025 é«˜é›„è–èª•è·¨å¹´åœ°åœ– - AIè¦ªå­æˆé•·å±‹</title>
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: "Noto Sans TC", sans-serif;
            background-color: #0f1c3f;
            color: #fff;
            overflow: hidden;
        }

        /* --- æ¨™é¡Œå€åŸŸ --- */
        #header {
            position: absolute;
            top: 15px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            /* æ”¹ç‚ºè–èª•ç´…æ¼¸å±¤èƒŒæ™¯ */
            background: linear-gradient(to bottom, #d90429 0%, #8d0801 100%);
            padding: 12px 35px;
            /* èª¿æ•´åœ“è§’ï¼Œä½¿å…¶çœ‹èµ·ä¾†åƒæ‡¸æ›çš„æ´»å‹•æ‹›ç‰Œ */
            border-radius: 12px;
            /* é‡‘è‰²é‚Šæ¡†èˆ‡å…§å¤–ç™¼å…‰æ•ˆæœ */
            border: 2px solid #ffd700;
            box-shadow: 
                0 8px 25px rgba(0,0,0,0.6), /* å¤–éƒ¨æ·±é™°å½± */
                inset 0 0 15px rgba(255, 215, 0, 0.3); /* å…§éƒ¨é‡‘è‰²å…‰æšˆ */
            text-align: center;
            min-width: 280px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        /* é ‚éƒ¨è£é£¾é‡˜é‡¦æ•ˆæœ (é¸ç”¨ï¼Œå¢åŠ è³ªæ„Ÿ) */
        #header::before {
            content: 'âœ¦';
            position: absolute;
            top: -12px;
            color: #ffd700;
            font-size: 1.2rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }

        h1 {
            margin: 0;
            color: #ffffff; /* ç™½è‰²å­—é«” */
            font-size: 1.35rem;
            display: flex;
            align-items: center;
            gap: 10px;
            /* ç«‹é«”æ–‡å­—æ•ˆæœï¼šé‡‘è‰²é™°å½± */
            text-shadow: 2px 2px 0px #b8860b, 0 0 10px rgba(255, 215, 0, 0.5);
            font-weight: 800;
        }

        p.subtitle {
            margin: 5px 0 0 0;
            color: #ffd700; /* äº®é‡‘è‰² */
            font-weight: 700;
            font-size: 0.85rem;
            letter-spacing: 3px;
            text-transform: uppercase;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
            border-top: 1px solid rgba(255, 215, 0, 0.3);
            padding-top: 3px;
            width: 100%;
        }

        /* --- åœ°åœ–å®¹å™¨ --- */
        #map {
            height: calc(100% - 70px); /* æ‰£é™¤åº•éƒ¨ Footer é«˜åº¦ */
            width: 100%;
            background: #cdcdcd;
        }

        /* --- å¯ç¸®æ”¾åœ–ç¤ºèªªæ˜ (Legend) --- */
        #legend {
            position: absolute;
            bottom: 90px; /* ä½æ–¼ Footer ä¸Šæ–¹ */
            right: 15px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            z-index: 1000;
            color: #333;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            font-size: 0.85rem;
            border-left: 5px solid #c41e3a;
            width: 180px;
            transition: all 0.3s ease;
            overflow: hidden;
        }

        /* æ”¶åˆç‹€æ…‹ */
        #legend.collapsed {
            width: 140px;
        }
        #legend.collapsed .legend-items {
            max-height: 0;
            padding-bottom: 0;
            opacity: 0;
        }
        #legend.collapsed .toggle-icon {
            transform: rotate(-90deg);
        }

        .legend-header {
            padding: 10px 15px;
            font-weight: bold;
            color: #0f1c3f;
            border-bottom: 1px solid #ddd;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #f8f9fa;
        }
        .legend-header:hover {
            background: #eee;
        }
        .toggle-icon {
            transition: transform 0.3s ease;
            color: #c41e3a;
        }

        .legend-items {
            padding: 10px 15px;
            max-height: 200px; /* å±•é–‹é«˜åº¦ */
            transition: max-height 0.3s ease, opacity 0.3s ease;
            opacity: 1;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }
        .legend-item:last-child {
            margin-bottom: 0;
        }
        .legend-icon {
            width: 24px;
            text-align: center;
            margin-right: 8px;
            font-size: 1rem;
        }

        /* --- å›ºå®šåº•éƒ¨è³‡è¨Šæ¬„ (Footer) --- */
        #footer-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 70px;
            background: rgba(15, 28, 63, 0.95); /* æ·±è—è‰²èƒŒæ™¯ */
            backdrop-filter: blur(5px);
            z-index: 2000;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            box-sizing: border-box;
            border-top: 3px solid #c41e3a;
            color: #fff;
        }

        .footer-left {
            display: flex;
            flex-direction: column;
            gap: 5px;
            font-size: 0.8rem;
        }
        
        .footer-link {
            color: #ddd;
            text-decoration: none;
            transition: color 0.2s;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .footer-link:hover {
            color: #fff;
            text-decoration: underline;
        }

        .copyright {
            color: #888;
            font-size: 0.75rem;
        }

        .footer-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .social-label {
            font-size: 0.9rem;
            font-weight: bold;
            margin-right: 5px;
            display: none; /* æ‰‹æ©Ÿç‰ˆéš±è—æ–‡å­— */
        }
        @media (min-width: 600px) {
            .social-label { display: block; }
        }

        .social-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            color: white;
            text-decoration: none;
            transition: transform 0.2s;
            background: #444;
            font-size: 1.2rem;
        }
        .social-btn:hover {
            transform: scale(1.15);
        }
        .social-fb { background: #1877F2; }
        .social-ig { background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%); }
        .social-yt { background: #FF0000; }


        /* --- å½ˆå‡ºè¦–çª— (Popup) --- */
        .leaflet-popup-content-wrapper {
            border-radius: 12px;
            padding: 0;
            overflow: hidden;
            box-shadow: 0 3px 14px rgba(0,0,0,0.4);
        }
        .leaflet-popup-content {
            margin: 0;
            width: 300px !important; /* åŠ å¯¬ä¸€é»ä»¥å®¹ç´è©³ç´°æ–‡å­— */
        }
        .popup-header {
            background: #c41e3a;
            color: white;
            padding: 10px 15px;
            font-weight: bold;
            font-size: 1.1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .popup-body {
            padding: 12px 15px;
            background: #fff;
            color: #333;
        }
        .popup-desc {
            font-size: 0.9rem;
            margin-bottom: 10px;
            line-height: 1.6;
            color: #444;
        }
        .popup-desc strong {
            color: #c41e3a;
        }
        .popup-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 10px;
        }
        .popup-tag {
            background: #f0f2f5;
            color: #555;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            border: 1px solid #e1e4e8;
        }
        .popup-tag.activity {
            background: #fff0f0;
            color: #c41e3a;
            border-color: #ffcccc;
            font-weight: bold;
        }
        .popup-footer {
            padding: 10px 15px;
            background: #f9f9f9;
            border-top: 1px solid #eee;
            text-align: right;
        }
        .nav-btn {
            display: inline-block;
            background: #c41e3a;
            color: #ffffff !important;
            text-decoration: none;
            padding: 8px 18px;
            border-radius: 20px;
            font-size: 0.95rem;
            font-weight: bold;
            transition: background 0.2s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .nav-btn:hover {
            background: #a01830;
            color: #ffffff !important;
        }

        /* --- Marker Styles --- */
        .marker-pin {
            width: 36px;
            height: 36px;
            border-radius: 50% 50% 50% 0;
            position: absolute;
            transform: rotate(-45deg);
            left: 50%;
            top: 50%;
            margin: -18px 0 0 -18px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
            display: flex;
            justify-content: center;
            align-items: center;
            border: 2px solid white;
        }
        .marker-pin i {
            transform: rotate(45deg);
            font-size: 1rem;
            color: white;
        }

        .bg-red { background: #c41e3a; }
        .bg-green { background: #2c5e1a; }
        .bg-gold { background: #d4af37; }
        .bg-blue { background: #0066cc; }

        .pulse-ring {
            display: block;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: rgba(196, 30, 58, 0.4);
            animation: pulse 2s infinite;
            position: absolute;
            z-index: -1;
            transform: rotate(45deg);
        }
        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(1.6); opacity: 0; }
        }

        /* --- Snow Effect --- */
        .snowflake {
            position: fixed;
            top: -10px;
            color: #fff;
            user-select: none;
            pointer-events: none;
            z-index: 9999;
        }
        /* Mobile adjust */
        @media (max-width: 480px) {
            #legend { bottom: 80px; right: 10px; }
            .footer-left { max-width: 150px; }
            .footer-link span { display: none; } /* Hide link text if too narrow, keep icon */
            .footer-link::after { content: " æ—…éŠç¶²"; display: inline; }
            /* æ‰‹æ©Ÿç‰ˆèª¿æ•´å°å—åœ°åœ–æŒ‰éˆ•ä½ç½®ï¼Œé¿å…é®æ“‹ */
            #TN-map-btn { bottom: 160px !important; left: 10px !important; } 
        }

        /* --- å°å—åœ°åœ–å°å¼•æŒ‰éˆ• --- */
        #TN-map-btn {
            position: absolute;
            bottom: 90px;
            left: 15px;
            z-index: 1000;
            background: #c41e3a;
            color: white;
            padding: 10px 18px;
            border-radius: 30px;
            text-decoration: none;
            font-weight: bold;
            font-size: 0.95rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            border: 2px solid #ffd700;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s;
        }

        #TN-map-btn:hover {
            transform: translateY(-3px);
            background: #a01830;
            box-shadow: 0 6px 20px rgba(0,0,0,0.4);
        }

        #TN-map-btn i {
            color: #ffd700;
        }
    </style>
</head>
<body>

    <div id="header">
        <h1><i class="fa-solid fa-tree" style="color:#2c5e1a;"></i> é«˜é›„è–èª• è·¨å¹´åœ°åœ–</h1>
        <p class="subtitle">KAOHSIUNG CHRISTMAS 2026</p>
    </div>

    <!-- å°å—è–èª•åœ°åœ–å°å¼•æŒ‰éˆ• -->
    <a href="https://aifamily0708.github.io/Aifamily/Christmas_Tainan.html" id="TN-map-btn" target="_blank">
        <i class="fa-solid fa-map-location-dot"></i> å‰å¾€å°å—è–èª•åœ°åœ–
    </a>

    <div id="map"></div>

    <!-- å¯ç¸®æ”¾åœ–ç¤ºèªªæ˜ -->
    <div id="legend">
        <div class="legend-header" onclick="toggleLegend()">
            <span><i class="fa-solid fa-layer-group"></i> åœ–ç¤ºèªªæ˜</span>
            <i class="fa-solid fa-chevron-down toggle-icon"></i>
        </div>
        <div class="legend-items">
            <div class="legend-item">
                <div class="legend-icon" style="color: #c41e3a;"><i class="fa-solid fa-star"></i></div>
                <span>è–èª•/è·¨å¹´é‡é»</span>
            </div>
            <div class="legend-item">
                <div class="legend-icon" style="color: #d4af37;"><i class="fa-solid fa-gift"></i></div>
                <span>å•†å ´/æ–‡å‰µåœ’å€</span>
            </div>
             <div class="legend-item">
                <div class="legend-icon" style="color: #0066cc;"><i class="fa-solid fa-location-dot"></i></div>
                <span>å…¶ä»–æ™¯é»</span>
            </div>
        </div>
    </div>

    <!-- å›ºå®šåº•éƒ¨è³‡è¨Šæ¬„ -->
    <div id="footer-bar">
        <div class="footer-left">
            <a href="https://khh.travel/" target="_blank" class="footer-link">
                <i class="fa-solid fa-circle-info"></i> <span>é«˜é›„æ—…éŠç¶²</span>
            </a>
            <span class="copyright">Â© 2025 AIè¦ªå­æˆé•·å±‹ å½™æ•´è£½ä½œ</span>
        </div>
        
        <div class="footer-right">
            <span class="social-label">AIè¦ªå­æˆé•·å±‹</span>
            <a href="https://www.facebook.com/profile.php?id=61579308823985" target="_blank" class="social-btn social-fb" title="Facebook"><i class="fa-brands fa-facebook-f"></i></a>
            <a href="https://www.instagram.com/aifamily0708?igsh=MXdlbzFsaTYxMDhidw%3D%3D&utm_source=qr" target="_blank" class="social-btn social-ig" title="Instagram"><i class="fa-brands fa-instagram"></i></a>
            <a href="https://www.youtube.com/@aifamily0708" target="_blank" class="social-btn social-yt" title="YouTube"><i class="fa-brands fa-youtube"></i></a>
        </div>
    </div>

    <div id="snow-container"></div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <script>
        // åˆå§‹åŒ–åœ°åœ– - æ”¹ç‚ºé«˜é›„å¸‚ä¸­å¿ƒè¦–è§’
        const map = L.map('map', {
            zoomControl: false 
        }).setView([22.63, 120.30], 12); // è¦–è§’èª¿æ•´

        // å°‡ç¸®æ”¾æ§åˆ¶é …ç§»åˆ°å³ä¸Šè§’
        L.control.zoom({
            position: 'topright'
        }).addTo(map);

        L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
            attribution: 'Â© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
            maxZoom: 19
        }).addTo(map);

        // åœ–ç¤ºèªªæ˜ç¸®æ”¾åŠŸèƒ½
        function toggleLegend() {
            const legend = document.getElementById('legend');
            legend.classList.toggle('collapsed');
        }

        // --- é«˜é›„è–èª•æ™¯é»è³‡æ–™åº« ---
        // åº§æ¨™å·²ç¶“éæ ¡æ­£
        const locations = [
            // --- è–èª•/è·¨å¹´é‡é» ---
            { 
                name: "ä¸­å¤®å…¬åœ’ æ°¸æ†æ˜Ÿå† ", 
                lat: 22.62410, lng: 120.30060, 
                type: "main", 
                icon: "fa-star", 
                area: "å‰é‡‘å€",
                desc: `
                    <strong>æ—¥æœŸï½œ</strong>å³æ—¥èµ·ï¼2026/01/04<br>
                    <strong>æ™‚é–“ï½œ</strong>17:30ï¼24:00 (22:00å¾Œç„¡éŸ³æ¨‚)<br>
                    <strong>äº®é»ï½œ</strong>æ¯30åˆ†é˜ç…™éœ§é›ªèŠ±ç‡ˆå…‰ç§€<br>
                    <strong>äº¤é€šï½œ</strong>æ·é‹ R9 ä¸­å¤®å…¬åœ’ç«™ 1 è™Ÿå‡ºå£
                `
            },
            { 
                name: "é«˜é›„æµè¡ŒéŸ³æ¨‚ä¸­å¿ƒ é‡‘å‹¾TREE", 
                lat: 22.61850, lng: 120.28750, 
                type: "main", 
                icon: "fa-music", 
                area: "é¹½åŸ•å€",
                desc: `
                    <strong>æ—¥æœŸï½œ</strong>å³æ—¥èµ·ï¼2026/01/04<br>
                    <strong>æ™‚é–“ï½œ</strong>17:30ï¼23:00<br>
                    <strong>ç‡ˆå…‰ç§€ï½œ</strong>18:00ï¼22:30 æ¯30åˆ†é˜<br>
                    <strong>åœ°é»ï½œ</strong>é«˜æµçŠç‘šç¤ç¾¤æˆ¶å¤–å ¤å²¸<br>
                    <strong>äº¤é€šï½œ</strong>è¼•è»Œ C12 å…‰æ¦®ç¢¼é ­ç«™
                `
            },
            
            // --- å•†å ´/æ™¯é» ---
            { 
                name: "æ£§è²³åº«KW2 æ¼‚æµ®è–èª•æ¨¹", 
                lat: 22.61620, lng: 120.27850, 
                type: "mall", 
                icon: "fa-tree", 
                area: "é¼“å±±å€",
                desc: `
                    <strong>æ—¥æœŸï½œ</strong>å³æ—¥èµ·ï¼2026/01/04<br>
                    <strong>é»ç‡ˆï½œ</strong>17:30ï¼22:00<br>
                    <strong>äº¤é€šï½œ</strong>è¼•è»Œ C13 é§äºŒè“¬èŠç«™
                `
            },
            { 
                name: "è¡›æ­¦ç‡Ÿ èŠ±éœ²éœ²è–èª•æ¨¹", 
                lat: 22.62350, lng: 120.34250, 
                type: "spot", 
                icon: "fa-tree", 
                area: "é³³å±±å€",
                desc: `
                    <strong>æ—¥æœŸï½œ</strong>å³æ—¥èµ·ï¼2026/01/04<br>
                    <strong>é»ç‡ˆï½œ</strong>17:30ï¼24:00<br>
                    <strong>é£„é›ªï½œ</strong>12/25 18:00ã€19:00ã€20:00<br>
                    <strong>äº¤é€šï½œ</strong>æ·é‹ O10 è¡›æ­¦ç‡Ÿç«™ 6 è™Ÿå‡ºå£
                `
            },
            { 
                name: "é«˜é›„å¸‚è­°æœƒ å…‰ä¹‹ç¦®ç‰©", 
                lat: 22.62680, lng: 120.34750, 
                type: "spot", 
                icon: "fa-gift", 
                area: "é³³å±±å€",
                desc: `
                    <strong>æ—¥æœŸï½œ</strong>å³æ—¥èµ·ï¼2026/01/31<br>
                    <strong>é»ç‡ˆï½œ</strong>17:30ï¼20:30<br>
                    <strong>äº¤é€šï½œ</strong>æ·é‹ O11 é³³å±±è¥¿ç«™ 1 è™Ÿå‡ºå£
                `
            },
            { 
                name: "æ——å±±ç”Ÿæ´»æ–‡åŒ–åœ’å€ æ‹¾å…‰æ——å±±", 
                lat: 22.88720, lng: 120.48350, 
                type: "spot", 
                icon: "fa-clock", 
                area: "æ——å±±å€",
                desc: `
                    <strong>æ—¥æœŸï½œ</strong>å³æ—¥èµ·ï¼2026/01/02<br>
                    <strong>é»ç‡ˆï½œ</strong>17:00ï¼07:00<br>
                    <strong>äº¤é€šï½œ</strong>å®¢é‹ E25ã€E28ã€E32<br>
                    è‡³æ——å±±è½‰é‹ç«™æ­¥è¡Œç´„ 15 åˆ†é˜
                `
            },

            // --- æ•™æœƒæ´»å‹• ---
            { 
                name: "é«˜é›„æµ¸å®£æ­¦æ˜Œæ•™æœƒ", 
                lat: 22.62055, lng: 120.31125, 
                type: "church", 
                area: "è‹“é›…å€",
                desc: `
                    <div style="font-size:0.85rem; line-height:1.6;">
                        <strong style="color:#c41e3a;">å¸‚é›† x æ™šæœƒ x å ±ä½³éŸ³</strong><br>
                        <ul>
                            <li><strong>12/12-14</strong> 15:00 è€¶Yeah!å¸‚é›† <br><span style="color:#666;font-size:0.8rem;">(åœ°é»:å°å¡‘ç‹æ°æ˜†ä»²å…¬åœ’)</span></li>
                            <li><strong>12/13</strong> 18:00 å…’ç«¥è–èª•æ™šæœƒ</li>
                            <li><strong>12/20</strong> 19:00 å‰ç¦ç‰¹è£½é€ æ‰€æ™šæœƒ</li>
                            <li><strong>12/24</strong> 19:00 å»£å ´å ±ä½³éŸ³</li>
                        </ul>
                    </div>
                `
            },
            { 
                name: "é«˜é›„éˆç³§å ‚", 
                lat: 22.68450, lng: 120.30850, 
                type: "church", 
                area: "å·¦ç‡Ÿå€",
                desc: `
                    <div style="font-size:0.85rem; line-height:1.6;">
                        <strong style="color:#c41e3a;">åŸå‰µæˆ²åŠ‡ x è¦ªå­éŸ³æ¨‚åŠ‡</strong><br>
                        <ul>
                            <li><strong>12/21</strong> 08:30/10:30 å…’ç«¥éŸ³æ¨‚åŠ‡ã€Šä¸ƒéš»å°ç¾Šã€‹</li>
                            <li><strong>12/21</strong> 10:00 è¦ªå­æ´»å‹•ã€Šå¹¸.ç¦.æŠµ.å®¶ã€‹</li>
                            <li><strong>12/28</strong> 09:30 å¹´åº¦å¤§åŠ‡ã€Šæº«æ³‰è¡—æ—¥è¨˜ã€‹</li>
                        </ul>
                    </div>
                `
            },
            { 
                name: "å¾·ç”Ÿé•·è€æ•™æœƒ", 
                lat: 22.62880, lng: 120.30250, 
                type: "church", 
                area: "æ–°èˆˆå€",
                desc: `
                    <div style="font-size:0.85rem; line-height:1.6;">
                        <strong style="color:#c41e3a;">ç®¡é¢¨ç´ x è©©ç­ x å‚³çµ±è–èª•</strong><br>
                        <ul>
                            <li><strong>12/21</strong> 09:00 è–èª•è¯åˆç¦®æ‹œ</li>
                            <li><strong>12/21</strong> 15:00 è»Šç«™å ±ä½³éŸ³ <br><span style="color:#666;font-size:0.8rem;">(åœ°é»:é«˜é›„ç«è»Šç«™)</span></li>
                            <li><strong>12/24</strong> 19:30 å¹³å®‰å¤œç‡­å…‰ç¦±å‘Šæœƒ</li>
                        </ul>
                    </div>
                `
            },
            { 
                name: "å‰é‡‘é•·è€æ•™æœƒ", 
                lat: 22.61980, lng: 120.29350, 
                type: "church", 
                area: "å‰é‡‘å€",
                desc: `
                    <div style="font-size:0.85rem; line-height:1.6;">
                        <strong style="color:#c41e3a;">æº«é¦¨å¹³å®‰å¤œå‚³çµ±</strong><br>
                        <ul>
                            <li><strong>12/24</strong> 18:30 è–èª•å¸‚é›†+å°è©©ç­</li>
                            <li><strong>12/24</strong> 19:30 è–èª•æ™šæœƒ</li>
                            <li><strong>12/24</strong> 21:30 å¤©ä½¿å ±ä½³éŸ³</li>
                        </ul>
                    </div>
                `
            },
            { 
                name: "ç«ç‘°è–æ¯è–æ®¿ä¸»æ•™åº§å ‚", 
                lat: 22.62030, lng: 120.29050, 
                type: "church", 
                area: "è‹“é›…å€",
                desc: `
                    <div style="font-size:0.85rem; line-height:1.6;">
                        <strong style="color:#c41e3a;">å°ç£ç¬¬ä¸€åº§å¤©ä¸»å ‚ x èŠåš´å½Œæ’’</strong><br>
                        <ul>
                            <li><strong>12/20</strong> 20:00 å°‡è‡¨æœŸå½Œæ’’(å°èª)</li>
                            <li><strong>12/21</strong> 09/11/16:00 ä¸»æ—¥å½Œæ’’</li>
                            <li><strong>12/29</strong> 15:00 ç¦§å¹´é–‹å¹•éŠè¡Œæš¨å½Œæ’’</li>
                        </ul>
                    </div>
                `
            },
            { 
                name: "é³³å±±æ´»æ³‰éˆç³§å ‚", 
                lat: 22.62550, lng: 120.36850, 
                type: "church", 
                area: "é³³å±±å€",
                desc: `
                    <div style="font-size:0.85rem; line-height:1.6;">
                        <strong style="color:#c41e3a;">å¹´åº¦è–èª•æˆ²åŠ‡</strong><br>
                        <ul>
                            <li><strong>12/13ã€12/14</strong><br>æ´»æ³‰è–èª•åŠ‡æ¼”å‡º</li>
                        </ul>
                    </div>
                `
            },
            { 
                name: "æ——å±±é•·è€æ•™æœƒ", 
                lat: 22.88560, lng: 120.48380, 
                type: "church", 
                area: "æ——å±±å€",
                desc: `
                    <div style="font-size:0.85rem; line-height:1.6;">
                        <strong style="color:#c41e3a;">æ——å±±é™å®š x é¦™è•‰è–èª•ç‰†</strong><br>
                        <ul>
                            <li><strong>ç‰¹è‰²ï½œ</strong>è¶…ç´šæ‡‰æ™¯çš„æ——å±±é¦™è•‰è–èª•æ‰“å¡ç‰†ï¼</li>
                            <li><strong>æœŸé–“ï½œ</strong>å³æ—¥èµ·è‡³è–èª•æœŸé–“</li>
                        </ul>
                    </div>
                `
            }
        ];

        function createCustomIcon(location) {
            let className = '';
            let iconClass = location.icon || 'fa-map-marker-alt';
            let isPulse = false;

            switch(location.type) {
                case 'main': className = 'bg-red'; isPulse = true; if (!location.icon) iconClass = 'fa-star'; break;
                case 'church': className = 'bg-green'; if (!location.icon) iconClass = 'fa-church'; break;
                case 'mall': className = 'bg-gold'; if (!location.icon) iconClass = 'fa-gift'; break;
                case 'spot': className = 'bg-blue'; break;
            }

            const pulseHtml = isPulse ? '<span class="pulse-ring"></span>' : '';
            
            return L.divIcon({
                className: 'custom-div-icon',
                html: `<div class='marker-pin ${className}'>
                        ${pulseHtml}
                        <i class='fa-solid ${iconClass}'></i>
                       </div>`,
                iconSize: [36, 36],
                iconAnchor: [18, 42],
                popupAnchor: [0, -40]
            });
        }

        locations.forEach(loc => {
            const marker = L.marker([loc.lat, loc.lng], {
                icon: createCustomIcon(loc)
            }).addTo(map);

            const typeLabel = {
                'main': 'ğŸ„ ç„¦é»æ´»å‹•',
                'church': 'â›ª æ•™æœƒé»ç‡ˆ',
                'mall': 'ğŸ å•†åœˆ/æ–‡å‰µ',
                'spot': 'âœ¨ è§€å…‰æ™¯é»'
            }[loc.type];

            // å°èˆªé€£çµ
            const searchTerm = encodeURIComponent(loc.name + " " + (loc.area || "é«˜é›„"));
            const googleMapUrl = `https://www.google.com/maps/search/?api=1&query=${searchTerm}`;

            const popupContent = `
                <div class="popup-header">
                    <span>${loc.name}</span>
                    <i class="fa-solid ${loc.type === 'main' ? 'fa-star' : 'fa-location-dot'}" style="opacity:0.8"></i>
                </div>
                <div class="popup-body">
                    <div class="popup-tags">
                        <span class="popup-tag ${loc.type === 'main' ? 'activity' : ''}">${typeLabel}</span>
                        ${loc.area ? `<span class="popup-tag">${loc.area}</span>` : ''}
                    </div>
                    <div class="popup-desc">
                        ${loc.desc}
                    </div>
                </div>
                <div class="popup-footer">
                    <a href="${googleMapUrl}" target="_blank" class="nav-btn">
                        <i class="fa-solid fa-location-arrow"></i> å°èˆªå»
                    </a>
                </div>
            `;

            marker.bindPopup(popupContent);
        });

        function createSnow() {
            const container = document.getElementById('snow-container');
            const snowflakesCount = window.innerWidth < 768 ? 25 : 50; 

            for (let i = 0; i < snowflakesCount; i++) {
                const snow = document.createElement('div');
                snow.className = 'snowflake';
                snow.innerHTML = 'â„';
                snow.style.left = Math.random() * 100 + '%';
                snow.style.animation = `fall ${(Math.random() * 5 + 5)}s linear infinite`;
                snow.style.animationDelay = -Math.random() * 10 + 's';
                snow.style.opacity = Math.random() * 0.7 + 0.3;
                snow.style.fontSize = (Math.random() * 10 + 10) + 'px';
                container.appendChild(snow);
            }
            
            const style = document.createElement('style');
            style.innerHTML = `
                @keyframes fall {
                    0% { transform: translateY(-10vh) translateX(-10px) rotate(0deg); }
                    100% { transform: translateY(100vh) translateX(10px) rotate(360deg); }
                }
            `;
            document.head.appendChild(style);
        }

        createSnow();
    </script>
</body>
</html>
